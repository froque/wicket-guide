<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>18 Integration with enterprise containers 1.0.0.BUILD-SNAPSHOT</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <ul>
        <li>
            <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                <a href="../guide/index.html" class="button">Table of contents</a>

                <div id="nav-summary-childs" style="display:none;">
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter1.html"><strong>1</strong><span>Introduction</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter2.html"><strong>2</strong><span>Why should I learn Wicket?</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter3.html"><strong>3</strong><span>Wicket says &ldquo;Hello world!&rdquo;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter4.html"><strong>4</strong><span>Wicket as page layout manager</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter5.html"><strong>5</strong><span>Keeping control over HTML</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter6.html"><strong>6</strong><span>Components lifecycle</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter7.html"><strong>7</strong><span>Page versioning and caching</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter8.html"><strong>8</strong><span>Under the hood of the request processing</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter9.html"><strong>9</strong><span>Wicket Links and URL generation</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter10.html"><strong>10</strong><span>Wicket models and forms</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter11.html"><strong>11</strong><span>Wicket forms in detail</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter12.html"><strong>12</strong><span>Displaying multiple items with repeaters</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter13.html"><strong>13</strong><span>Internationalization with Wicket</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter14.html"><strong>14</strong><span>Resource management with Wicket</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter15.html"><strong>15</strong><span>An example of integration with JavaScript</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter16.html"><strong>16</strong><span>Wicket advanced topics</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter17.html"><strong>17</strong><span>Working with AJAX</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter18.html"><strong>18</strong><span>Integration with enterprise containers</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter19.html"><strong>19</strong><span>Security with Wicket</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter20.html"><strong>20</strong><span>Test Driven Development with Wicket</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter21.html"><strong>21</strong><span>Test Driven Development with Wicket and Spring</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter22.html"><strong>22</strong><span>Wicket Best Practices</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter23.html"><strong>23</strong><span>Working with Maven (Appendix)</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter24.html"><strong>24</strong><span>Project WicketStuff (Appendix)</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter25.html"><strong>25</strong><span>Lost In Redirection With Apache Wicket (Appendix)</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/chapter26.html"><strong>26</strong><span>Contributing to this guide (Appendix)</span></a>
                    </div>
                    
                </div>
            </div>
        </li>
        <li class="separator selected">
            <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
        </li>
    </ul>
</div>
<div id="header">
    <div class="images clearfix">
        
        <span id="logo"><a href="/" target="_blank"><img height="80px" src="http://comsysto.github.io/wicket-userguide/img/apache-wicket.png"/></a></span>
        
        
        <span id="sponsor"><a href="http://www.comsysto.com/" target="_blank"><img height="60px" src="http://comsysto.github.io/wicket-userguide/img/comsysto-logo.png"/></a></span>
        
    </div>
    <p>Free Online Guide for Apache Wicket framework</p>
</div>


<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../guide/chapter17.html">&lt;&lt; <strong>17</strong><span>Working with AJAX</span></a></div>
                

                <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                
                    <div class="toc-item next-right"><a href="../guide/chapter19.html"><strong>19</strong><span>Security with Wicket</span> >></a></div>
                


                <div class="project">
                    <h1>18 Integration with enterprise containers - Reference Documentation</h1>

                    <p><strong>Authors:</strong> Andrea Del Bene, Carsten Hufe, Christian Kroemer, Daniel Bartl</p>

                    <p><strong>Version:</strong> 1.0.0.BUILD-SNAPSHOT</p>

                    
                </div>

                
                <div id="table-of-content">
                    <h2>Table of Contents</h2>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#chapter18_1"><strong>18.1</strong><span>Integrating Wicket with EJB</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#chapter18_2"><strong>18.2</strong><span>Integrating Wicket with Spring</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#chapter18_3"><strong>18.3</strong><span>JSR-330 annotations</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#chapter18_4"><strong>18.4</strong><span>Summary</span></a>
                    </div>
                    
                </div>
                

                

<h1 id="chapter18">18 Integration with enterprise containers</h1>
Writing a web application is not just about producing a good layout and a bunch of “cool” pages. We must also integrate our presentation code with enterprise resources like data sources, message queues, business objects, etc...<p class="paragraph"/>The first decade of 2000s has seen the rising of new frameworks (like <a href="http://www.springsource.org/" target="blank">Spring</a> ) and new specifications (like <a href="http://en.wikipedia.org/wiki/Enterprise_JavaBeans" target="blank">EJB 3.1</a> ) aimed to simplify the management of enterprise resources and (among other things) their integration with presentation code.<p class="paragraph"/>All these new technologies are based on the concepts of container and dependency injection. Container is the environment where our enterprise resources are created and configured while  <a href="http://en.wikipedia.org/wiki/Dependency_Injection" target="blank">dependency injection</a> is a pattern implemented by containers to inject into an object the resources it depends on.<p class="paragraph"/>Wicket can be easily integrated with enterprise containers using component instantiation listeners. These entities are instances of interface org.apache.wicket.application.IComponent InstantiationListener and can be registered during application's initialization.   IComponentInstantiationListener defines callback method onInstantiation(Component component) which can be used to provide custom instantiation logic for Wicket components.<p class="paragraph"/>Wicket distribution and project <a href="https://github.com/wicketstuff" target="blank">WicketStuff</a> already provide a set of built-in listeners to integrate our applications with EJB 3.1 compliant containers (like JBoss Seam) or with some of the most popular enterprise frameworks like <a href="http://code.google.com/p/google-guice/" target="blank">Guice</a> or Spring.<p class="paragraph"/>In this chapter we will see two basic examples of injecting a container-defined object into a page using first an implementation of the EJB 3.1 specifications (project <a href="http://openejb.apache.org/" target="blank">OpenEJB</a> ) and then using Spring.


<h2 id="chapter18_1">18.1 Integrating Wicket with EJB</h2>
<p class="paragraph"/>WicketStuff provides a module called wicketstuff-javaee-inject that contains component instantiation listener JavaEEComponentInjector. If we register this listener in our application we can use standard EJB annotations to inject dependencies into our Wicket components.<p class="paragraph"/>To register a component instantiation listener in Wicket we must use Application's method getComponentInstantiationListeners which returns a typed collection of IComponent InstantiationListeners.<p class="paragraph"/>The following initialization code is taken from project EjbInjectionExample:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> class WicketApplication <span class="java&#45;keyword">extends</span> WebApplication
&#123;    	
       //Constructor...<p class="paragraph"/>	@Override
	<span class="java&#45;keyword">public</span> void init()
	&#123;
		<span class="java&#45;keyword">super</span>.init();
		getComponentInstantiationListeners().add(<span class="java&#45;keyword">new</span> JavaEEComponentInjector(<span class="java&#45;keyword">this</span>));		
	&#125;	
&#125;</pre></div><p class="paragraph"/>In this example the object that we want to inject is a simple class containing a greeting message:<p class="paragraph"/><div class="code"><pre>@ManagedBean
<span class="java&#45;keyword">public</span> class EnterpriseMessage &#123;
	<span class="java&#45;keyword">public</span> <span class="java&#45;object">String</span> message = <span class="java&#45;quote">"Welcome to the EJB world!"</span>;
&#125;</pre></div><p class="paragraph"/>Please note that we have used annotation <code>ManagedBean to decorate our object. Now to inject it into the home page we must add a field of type EnterpriseMessage and annotate it with annotation </code>EJB:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> class HomePage <span class="java&#45;keyword">extends</span> WebPage &#123;<p class="paragraph"/>	@EJB
	<span class="java&#45;keyword">private</span> EnterpriseMessage enterpriseMessage;
	//getter and setter <span class="java&#45;keyword">for</span> enterpriseMessage...<p class="paragraph"/>	<span class="java&#45;keyword">public</span> HomePage(<span class="java&#45;keyword">final</span> PageParameters parameters) &#123;
		<span class="java&#45;keyword">super</span>(parameters);<p class="paragraph"/>		add(<span class="java&#45;keyword">new</span> Label(<span class="java&#45;quote">"message"</span>, enterpriseMessage.message));
	&#125;
&#125;</pre></div><p class="paragraph"/>That is all. We can point the browser to the home page of the project and see the greeting message injected into the page:<p class="paragraph"/><img border="0" class="center" src="../img/EjbInjectionExample.png"></img>


<h2 id="chapter18_2">18.2 Integrating Wicket with Spring</h2>
<p class="paragraph"/>If we need to inject dependencies with Spring we can use listener org.apache.wicket.spring. injection.annot.SpringComponentInjector provided by module wicket-spring.<p class="paragraph"/>For the sake of simplicity in the example project SpringInjectionExample we have used Spring class AnnotationConfigApplicationContext to avoid any XML file and create a Spring context directly from code:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> class WicketApplication <span class="java&#45;keyword">extends</span> WebApplication
&#123;      
  //Constructor...<p class="paragraph"/>  @Override
  <span class="java&#45;keyword">public</span> void init()
  &#123;
    <span class="java&#45;keyword">super</span>.init();<p class="paragraph"/>    AnnotationConfigApplicationContext ctx = <span class="java&#45;keyword">new</span> AnnotationConfigApplicationContext();
    //Scan <span class="java&#45;keyword">package</span> <span class="java&#45;keyword">for</span> annotated beans
    ctx.scan(<span class="java&#45;quote">"org.wicketTutorial.ejbBean"</span>);
    ctx.refresh();<p class="paragraph"/>    getComponentInstantiationListeners().add(<span class="java&#45;keyword">new</span> SpringComponentInjector(<span class="java&#45;keyword">this</span>, ctx));
  &#125;	
&#125;</pre></div><p class="paragraph"/>As we can see in the code above, the constructor of SpringComponentInjector takes in input also an instance of Spring context.<p class="paragraph"/>The injected object is the same used in the previous project EjbInjectionExample, it differs only for the greeting message:<p class="paragraph"/><div class="code"><pre>@ManagedBean
<span class="java&#45;keyword">public</span> class EnterpriseMessage &#123;
	<span class="java&#45;keyword">public</span> <span class="java&#45;object">String</span> message = <span class="java&#45;quote">"Welcome to the Spring world!"</span>;
&#125;</pre></div><p class="paragraph"/>In the home page of the project the object is injected using Wicket annotation @SpringBean:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> class HomePage <span class="java&#45;keyword">extends</span> WebPage &#123;
  @SpringBean
  <span class="java&#45;keyword">private</span> EnterpriseMessage enterpriseMessage;
  //getter and setter <span class="java&#45;keyword">for</span> enterpriseMessage...<p class="paragraph"/>  <span class="java&#45;keyword">public</span> HomePage(<span class="java&#45;keyword">final</span> PageParameters parameters) &#123;
  	<span class="java&#45;keyword">super</span>(parameters);<p class="paragraph"/>	add(<span class="java&#45;keyword">new</span> Label(<span class="java&#45;quote">"message"</span>, enterpriseMessage.message));
  &#125;
&#125;</pre></div><p class="paragraph"/>By default @SpringBean searches into Spring context for a bean having the same type of the annotated field. If we want we can specify also the name of the bean to use as injected object and we can declare if the dependency is required or not. By default dependencies are required and if they can not be resolved to a compatible bean, Wicket will throw an IllegalStateException:<p class="paragraph"/><div class="code"><pre>//set the dependency as not required, i.e the field can be left <span class="java&#45;keyword">null</span>
  @SpringBean(name=<span class="java&#45;quote">"anotherName"</span>, required=<span class="java&#45;keyword">false</span>)
  <span class="java&#45;keyword">private</span> EnterpriseMessage enterpriseMessage;</pre></div>


<h2 id="chapter18_3">18.3 JSR-330 annotations</h2>
<p class="paragraph"/>Spring (and Guice) users can use standard <a href="http://jcp.org/en/jsr/detail?id=330" target="blank">JSR-330</a> annotations to wire their dependencies. This will make their code more interoperable with other containers that support this standard:<p class="paragraph"/><div class="code"><pre>//inject a bean specifying its name with JSR&#45;330 annotations
  <code>Inject </code>Named(<span class="java&#45;quote">"anotherName"</span>)
  <span class="java&#45;keyword">private</span> EnterpriseMessage enterpriseMessage;</pre></div>


<h2 id="chapter18_4">18.4 Summary</h2>
<p class="paragraph"/>In this chapter we have seen how to integrate Wicket applications with Spring and with an EJB container. Module wicket-examples contains also an example of integration with Guice (see application class org.apache.wicket.examples.guice.GuiceApplication).<p class="paragraph"/>



                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../guide/chapter17.html">&lt;&lt; <strong>17</strong><span>Working with AJAX</span></a></div>
                
                    <div class="toc-item next-right"><a href="../guide/chapter19.html"><strong>19</strong><span>Security with Wicket</span> >></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    
Copyright &copy; 2013 — <a href="http://www.comsysto.com" target="_blank">comSysto GmbH</a>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-43124634-1', 'comsysto.com');
  ga('send', 'pageview');

</script>

    
</div>

<script type="text/javascript" src="../js/docs.js"></script>

</body>
</html>
